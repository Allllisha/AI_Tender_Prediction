#!/usr/bin/env python3
"""
mock_tender_data_100.jsonの都道府県・市区町村・発注者を実際のデータに修正するスクリプト
"""

import json
import random
from pathlib import Path

# 実際の都道府県と市区町村の組み合わせ
PREFECTURE_CITY_DATA = {
    "東京都": {
        "cities": ["千代田区", "中央区", "港区", "新宿区", "文京区", "台東区", "墨田区", "江東区", 
                  "品川区", "目黒区", "大田区", "世田谷区", "渋谷区", "中野区", "杉並区", "豊島区",
                  "北区", "荒川区", "板橋区", "練馬区", "足立区", "葛飾区", "江戸川区", "八王子市",
                  "立川市", "武蔵野市", "三鷹市", "府中市", "調布市", "町田市", "小金井市", "国分寺市"],
        "publisher_types": ["東京都", "東京都教育委員会", "東京都建設局", "東京都水道局", "東京都交通局", "東京都病院経営本部"]
    },
    "神奈川県": {
        "cities": ["横浜市", "川崎市", "相模原市", "横須賀市", "平塚市", "鎌倉市", "藤沢市", "小田原市",
                  "茅ヶ崎市", "逗子市", "三浦市", "秦野市", "厚木市", "大和市", "伊勢原市", "海老名市"],
        "publisher_types": ["神奈川県", "神奈川県教育委員会", "神奈川県企業庁", "神奈川県道路公社"]
    },
    "大阪府": {
        "cities": ["大阪市", "堺市", "岸和田市", "豊中市", "池田市", "吹田市", "泉大津市", "高槻市",
                  "貝塚市", "守口市", "枚方市", "茨木市", "八尾市", "泉佐野市", "富田林市", "寝屋川市"],
        "publisher_types": ["大阪府", "大阪府教育委員会", "大阪府都市整備部", "大阪府住宅まちづくり部"]
    },
    "愛知県": {
        "cities": ["名古屋市", "豊橋市", "岡崎市", "一宮市", "瀬戸市", "半田市", "春日井市", "豊川市",
                  "津島市", "碧南市", "刈谷市", "豊田市", "安城市", "西尾市", "蒲郡市", "犬山市"],
        "publisher_types": ["愛知県", "愛知県教育委員会", "愛知県建設局", "愛知県企業庁"]
    },
    "福岡県": {
        "cities": ["北九州市", "福岡市", "大牟田市", "久留米市", "直方市", "飯塚市", "田川市", "柳川市",
                  "八女市", "筑後市", "大川市", "行橋市", "豊前市", "中間市", "小郡市", "筑紫野市"],
        "publisher_types": ["福岡県", "福岡県教育委員会", "福岡県県土整備部", "福岡県建築都市部"]
    },
    "北海道": {
        "cities": ["札幌市", "函館市", "小樽市", "旭川市", "室蘭市", "釧路市", "帯広市", "北見市",
                  "夕張市", "岩見沢市", "網走市", "留萌市", "苫小牧市", "稚内市", "美唄市", "芦別市"],
        "publisher_types": ["北海道", "北海道教育委員会", "北海道開発局", "北海道建設部"]
    },
    "宮城県": {
        "cities": ["仙台市", "石巻市", "塩竈市", "気仙沼市", "白石市", "名取市", "角田市", "多賀城市",
                  "岩沼市", "登米市", "栗原市", "東松島市", "大崎市", "富谷市"],
        "publisher_types": ["宮城県", "宮城県教育委員会", "宮城県土木部", "宮城県企業局"]
    },
    "広島県": {
        "cities": ["広島市", "呉市", "竹原市", "三原市", "尾道市", "福山市", "府中市", "三次市",
                  "庄原市", "大竹市", "東広島市", "廿日市市", "安芸高田市", "江田島市"],
        "publisher_types": ["広島県", "広島県教育委員会", "広島県土木建築局", "広島県企業局"]
    },
    "京都府": {
        "cities": ["京都市", "福知山市", "舞鶴市", "綾部市", "宇治市", "宮津市", "亀岡市", "城陽市",
                  "向日市", "長岡京市", "八幡市", "京田辺市", "京丹後市", "南丹市", "木津川市"],
        "publisher_types": ["京都府", "京都府教育委員会", "京都府建設交通部", "京都府営繕課"]
    },
    "千葉県": {
        "cities": ["千葉市", "銚子市", "市川市", "船橋市", "館山市", "木更津市", "松戸市", "野田市",
                  "茂原市", "成田市", "佐倉市", "東金市", "旭市", "習志野市", "柏市", "勝浦市"],
        "publisher_types": ["千葉県", "千葉県教育委員会", "千葉県県土整備部", "千葉県企業局"]
    },
    "埼玉県": {
        "cities": ["さいたま市", "川越市", "熊谷市", "川口市", "行田市", "秩父市", "所沢市", "飯能市",
                  "加須市", "本庄市", "東松山市", "春日部市", "狭山市", "羽生市", "鴻巣市", "深谷市"],
        "publisher_types": ["埼玉県", "埼玉県教育委員会", "埼玉県県土整備部", "埼玉県企業局"]
    },
    "兵庫県": {
        "cities": ["神戸市", "姫路市", "尼崎市", "明石市", "西宮市", "洲本市", "芦屋市", "伊丹市",
                  "相生市", "豊岡市", "加古川市", "赤穂市", "西脇市", "宝塚市", "三木市", "高砂市"],
        "publisher_types": ["兵庫県", "兵庫県教育委員会", "兵庫県県土整備部", "兵庫県企業庁"]
    },
    "静岡県": {
        "cities": ["静岡市", "浜松市", "沼津市", "熱海市", "三島市", "富士宮市", "伊東市", "島田市",
                  "富士市", "磐田市", "焼津市", "掛川市", "藤枝市", "御殿場市", "袋井市", "下田市"],
        "publisher_types": ["静岡県", "静岡県教育委員会", "静岡県交通基盤部", "静岡県企業局"]
    },
    "新潟県": {
        "cities": ["新潟市", "長岡市", "三条市", "柏崎市", "新発田市", "小千谷市", "加茂市", "十日町市",
                  "見附市", "村上市", "燕市", "糸魚川市", "妙高市", "五泉市", "上越市", "阿賀野市"],
        "publisher_types": ["新潟県", "新潟県教育委員会", "新潟県土木部", "新潟県企業局"]
    },
    "長野県": {
        "cities": ["長野市", "松本市", "上田市", "岡谷市", "飯田市", "諏訪市", "須坂市", "小諸市",
                  "伊那市", "駒ヶ根市", "中野市", "大町市", "飯山市", "茅野市", "塩尻市", "佐久市"],
        "publisher_types": ["長野県", "長野県教育委員会", "長野県建設部", "長野県企業局"]
    },
    "岐阜県": {
        "cities": ["岐阜市", "大垣市", "高山市", "多治見市", "関市", "中津川市", "美濃市", "瑞浪市",
                  "羽島市", "恵那市", "美濃加茂市", "土岐市", "各務原市", "可児市", "山県市", "瑞穂市"],
        "publisher_types": ["岐阜県", "岐阜県教育委員会", "岐阜県県土整備部", "岐阜県都市建築部"]
    },
    "栃木県": {
        "cities": ["宇都宮市", "足利市", "栃木市", "佐野市", "鹿沼市", "日光市", "小山市", "真岡市",
                  "大田原市", "矢板市", "那須塩原市", "さくら市", "那須烏山市", "下野市"],
        "publisher_types": ["栃木県", "栃木県教育委員会", "栃木県県土整備部", "栃木県企業局"]
    },
    "群馬県": {
        "cities": ["前橋市", "高崎市", "桐生市", "伊勢崎市", "太田市", "沼田市", "館林市", "渋川市",
                  "藤岡市", "富岡市", "安中市", "みどり市"],
        "publisher_types": ["群馬県", "群馬県教育委員会", "群馬県県土整備部", "群馬県企業局"]
    },
    "茨城県": {
        "cities": ["水戸市", "日立市", "土浦市", "古河市", "石岡市", "結城市", "龍ケ崎市", "下妻市",
                  "常総市", "常陸太田市", "高萩市", "北茨城市", "笠間市", "取手市", "牛久市", "つくば市"],
        "publisher_types": ["茨城県", "茨城県教育委員会", "茨城県土木部", "茨城県企業局"]
    },
    "福島県": {
        "cities": ["福島市", "会津若松市", "郡山市", "いわき市", "白河市", "須賀川市", "喜多方市", "相馬市",
                  "二本松市", "田村市", "南相馬市", "伊達市", "本宮市"],
        "publisher_types": ["福島県", "福島県教育委員会", "福島県土木部", "福島県企業局"]
    }
}

def get_publisher_name(prefecture, city, publisher_types):
    """発注者名を生成"""
    rand = random.random()
    
    if rand < 0.4:
        # 40%の確率で市区町村が発注者
        return f"{city}"
    elif rand < 0.6:
        # 20%の確率で市区町村の部局
        departments = ["教育委員会", "建設部", "都市整備部", "水道局"]
        return f"{city}{random.choice(departments)}"
    elif rand < 0.8:
        # 20%の確率で都道府県
        return random.choice(publisher_types)
    else:
        # 20%の確率で国の機関
        national = ["国土交通省関東地方整備局", "防衛省北関東防衛局", "厚生労働省", "文部科学省", 
                   "財務省関東財務局", "法務省", "農林水産省関東農政局"]
        return random.choice(national)

def fix_mock_data():
    """モックデータの都道府県・市区町村・発注者を修正"""
    
    # 入力ファイル読み込み
    input_file = Path("/Users/anemoto/bid_kacho/data/raw/mock_tender_data_100.json")
    with open(input_file, 'r', encoding='utf-8') as f:
        data = json.load(f)
    
    # 各案件のデータを修正
    prefectures = list(PREFECTURE_CITY_DATA.keys())
    
    for item in data:
        # ランダムに都道府県を選択
        prefecture = random.choice(prefectures)
        prefecture_data = PREFECTURE_CITY_DATA[prefecture]
        
        # その都道府県から市区町村を選択
        city = random.choice(prefecture_data["cities"])
        
        # 発注者名を生成
        publisher = get_publisher_name(prefecture, city, prefecture_data["publisher_types"])
        
        # データを更新
        item["prefecture"] = prefecture
        item["municipality"] = city
        item["publisher"] = publisher
    
    # 出力ファイルに保存
    output_file = Path("/Users/anemoto/bid_kacho/data/raw/mock_tender_data_100_fixed.json")
    with open(output_file, 'w', encoding='utf-8') as f:
        json.dump(data, f, ensure_ascii=False, indent=2)
    
    print(f"修正済みデータを {output_file} に保存しました")
    
    # 元のファイルを上書き
    with open(input_file, 'w', encoding='utf-8') as f:
        json.dump(data, f, ensure_ascii=False, indent=2)
    
    print(f"元のファイル {input_file} を更新しました")

if __name__ == "__main__":
    fix_mock_data()